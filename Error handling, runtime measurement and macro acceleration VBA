'Version from 1/30/2020
Private Const ThisModuleName As String = "Module Archive" ' имя модуля \ Module name
Option Explicit

Sub ProcessingAndAcceleration()
Dim ThisRoutineName As String: ThisRoutineName = "ProcessingAndAcceleration": Dim part As String 'имя поцедуры \ Procedure name
part0: On Error GoTo ErrorHandler: part = "part0": Application.StatusBar = "execute part of the script: " & part: DoEvents
'-------------------------------
    StaffApplicationOFF (False)
    Dim iTimer As Single: iTimer = Timer: Dim T As Single: T = Timer
'   LOG.myLOG ThisModuleName, ThisRoutineName, Now(), Me.CommandButton2.Caption
'----------------------------------------------
part1: On Error GoTo ErrorHandler: part = "part1": Application.StatusBar = "execute part of the script: " & part: DoEvents
'----------------------------------------------

'   your code is here

'----------------------------------------------
part2: On Error GoTo ErrorHandler: part = "part2": Application.StatusBar = "execute part of the script: " & part: DoEvents
'----------------------------------------------

'   your code is here
'   Call Show_MsgSistem_Or_No(0, , "Нажимать нужно только один раз!!!")
    
'----------------------------------------------
part3: On Error GoTo ErrorHandler: part = "part3": Application.StatusBar = "execute part of the script: " & part: DoEvents
'----------------------------------------------

'   your code is here
    If Application.UserName Like "*Korshakov*" Then: Dim a As Long: a = a + 1
    
EXIT_RTN:
'   LOG.myLOG ThisModuleName, ThisRoutineName, Now(), Me.CommandButton2.Caption, "Успешно \ Successfully"
    Debug.Print "Macro runtime " & ThisRoutineName & " " & Format((Timer - iTimer) / 86400, "Long Time") & " or " & Timer - T & " sec."
    StaffApplicationON (True)
    Exit Sub ' конец процедуры \ end of procedure
ErrorHandler:    CaseErr (Err)
'----------------------------------------------
'    Call the error reporting procedure
'    Call zzErrorReportBlank.ErrorReport(, ThisModuleName, ThisRoutineName, part, Str(Err.Number), Err.Source, Err.Description) 
    GoTo EXIT_RTN ' переход на завершение процедуры \ transition to completion of the procedure
'----------------------------------------------
End Sub

'Version from 8/30/2019
Public Function StaffApplicationON(Optional Switch As Boolean = False, Optional ScreenUpdating As Boolean = True, Optional Calculation As Boolean = True, _
                                    Optional DisplayAlerts As Boolean = True, Optional EnableEvents As Boolean = True)
If Switch Then
    IIf ScreenUpdating = True, Application.ScreenUpdating = True, Application.ScreenUpdating = False
    IIf Calculation = True, Application.Calculation = xlAutomatic, Application.Calculation = xlManual
    IIf DisplayAlerts = True, Application.DisplayAlerts = True, Application.DisplayAlerts = False
    IIf EnableEvents = True, Application.EnableEvents = True, Application.EnableEvents = False
End If
End Function

'Version from 8/30/2019
Public Function StaffApplicationOFF(Optional Switch As Boolean = False, Optional ScreenUpdating As Boolean = False, Optional Calculation As Boolean = False, _
                                    Optional DisplayAlerts As Boolean = False, Optional EnableEvents As Boolean = False)
If Switch Then
    IIf ScreenUpdating = False, Application.ScreenUpdating = False, Application.ScreenUpdating = True
    IIf Calculation = False, Application.Calculation = xlManual, Application.Calculation = xlAutomatic
    IIf DisplayAlerts = False, Application.DisplayAlerts = False, Application.DisplayAlerts = True
    IIf EnableEvents = False, Application.EnableEvents = True, Application.EnableEvents = True
End If
End Function

'Version from 8/30/2019
Public Function CaseErr(ByRef Err As Long)
Select Case Err ' сообщение с известными ошибками
    Case 5: MsgBox "Недопустимый вызов процедуры (Invalid procedure call)", vbCritical
    Case 7: MsgBox "Недостаточно памяти (Out of memory)", vbCritical
    Case 9: MsgBox "Индекс вне заданного диапазона (Subscript out of range)", vbCritical
    Case 53: MsgBox "Файл не найден (File not found)", vbCritical
    Case 11: MsgBox "Деление на ноль (Division by zero)", vbCritical
    Case 13: MsgBox "Ошибка типа данных (Type mismatch)", vbCritical
    Case 400: MsgBox "Форма уже отображается " & "(Form already displayed; can't show modally)", vbCritical
    Case 1004: MsgBox "Значение отсутствует", vbCritical
End Select
End Function
